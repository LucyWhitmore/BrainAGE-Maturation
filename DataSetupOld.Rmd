---
title: "DataSetup"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

packages <-  c("tidyverse",
               "reshape2",
               "nlme", "lme4",
               "data.table", "psych",
               "parallel","lubridate",
               "ggpubr", "broom", 
               "apaTables", "MetBrewer")
if (length(setdiff(packages, rownames(installed.packages()))) > 0) {
  install.packages(setdiff(packages, rownames(installed.packages())))  
}
lapply(packages, library, character.only = TRUE)
```


Load Structural Data
```{r}
#Load list of included subjects
struc_include<-rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_imgincl01.txt") %>%
  filter(!collection_title=="collection_title") %>% 
  select(1:12) %>% 
  mutate(interview_age = as.numeric(interview_age),
        imgincl_t1w_include = as.numeric(imgincl_t1w_include),
        imgincl_t2w_include = as.numeric(imgincl_t2w_include)) %>% 
  filter(imgincl_t1w_include == 1)

#Load structural data
#Filter for volume & area measurements
smri_1 <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_smrip10201.txt") %>%
  filter(!collection_title=="collection_title") %>% 
  filter(src_subject_id%in%struc_include$src_subject_id) %>% 
  select(subjectkey, src_subject_id, interview_age, sex, eventname, matches("vol|area")) %>% 
  select(-contains(c('cf'))) %>% #remove genetically derived parcellations
  select(-c(smri_area_cdk_totallh, smri_area_cdk_totalrh, smri_area_cdk_total, smri_vol_scs_lesionlh, smri_vol_scs_lesionrh, smri_vol_scs_wmhint, smri_vol_scs_wmhintlh, smri_vol_scs_wmhintrh, smri_vol_scs_wholeb, smri_vol_scs_latventricles, smri_vol_scs_allventricles, smri_vol_scs_cbwmatterrh, smri_vol_scs_cbwmatterlh))


smri_baseline <- smri_1%>% 
  filter(eventname=="baseline_year_1_arm_1")

smri_followup <- smri_1%>% 
  filter(eventname=="2_year_follow_up_y_arm_1")
  
#T1 intensity, might not need
#smri_2 <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_smrip20201.txt") %>%
 # filter(!collection_title=="collection_title") %>% 
 # filter(src_subject_id%in%struc_include$src_subject_id)

#Rename data to fit naming conventions
#????
ogfeatures <- rio::import("~/Documents/FYP/feature_list.txt")

```

Load Other Data
```{r}
#Puberty
youth_pds <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_ypdms01.txt") %>%
  filter(!collection_title=="collection_title")

youth_pub_sum <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_ssphy01.txt") %>%
  filter(!collection_title=="collection_title")

parent_pds <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_ppdms01.txt") %>%
  filter(!collection_title=="collection_title")

parent_pub_sum <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_ssphp01.txt") %>%
  filter(!collection_title=="collection_title")
  
saliva <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_hsss01.txt") %>%
  filter(!collection_title=="collection_title")

#parent sum scores abcd_mhp01
#youth sum scores abcd_mhy01
  
#Cognition
cognition <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_tbss01.txt") %>%
  filter(!collection_title=="collection_title") %>% 
  select(subjectkey, src_subject_id, interview_age, sex, eventname, nihtbx_fluidcomp_fc, nihtbx_cryst_fc, nihtbx_totalcomp_fc)

#Height/weight metrics
physical <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_ant01.txt") %>%
  filter(!collection_title=="collection_title")  %>% 
  select(subjectkey, src_subject_id, interview_age, sex, eventname, anthroheightcalc, anthroweightcalc)

#Sexual attraction and behavior
gish <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_gish2y01.txt") %>%
  filter(!collection_title=="collection_title") 

#Grade level, parent report
grade <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_gish2y01.txt") %>%
  filter(!collection_title=="collection_title") %>% 
  select(subjectkey, src_subject_id, interview_date, interview_age, sex, eventname, demo_ed_v2)
```

Template for renaming sMRI variables
```{r, eval=F}
renamed_smri_baseline <- smri_baseline %>% 
  rename(FS_InterCranial_Vol = smri_vol_scs_intracranialv, #technically inter vs intra
#FS_BrainSeg_Vol
#FS_BrainSeg_Vol_No_Vent
#FS_BrainSeg_Vol_No_Vent_Surf
FS_LCort_GM_Vol = smri_vol_cdk_totallh,
FS_RCort_GM_Vol = smri_vol_cdk_totalrh,
FS_TotCort_GM_Vol = smri_vol_cdk_total, #total whole brain cortical volume
FS_SubCort_GM_Vol = smri_vol_scs_subcorticalgv,
#FS_Total_GM_Vol #maybe just calculate?
FS_SupraTentorial_Vol = smri_vol_scs_suprateialv, #assuming this includes all ventricles
#FS_SupraTentorial_Vol_No_Vent  #smri_vol_scs_allventricles is all ventricles, subtract?
#FS_SupraTentorial_No_Vent_Voxel_Count
#FS_Mask_Vol
#FS_BrainSegVol_eTIV_Ratio
#FS_MaskVol_eTIV_Ratio
FS_L_LatVent_Vol = smri_vol_scs_ltventriclelh,
FS_L_InfLatVent_Vol = smri_vol_scs_inflatventlh,
FS_L_Cerebellum_WM_Vol = smri_vol_scs_crbwmatterlh,
FS_L_Cerebellum_Cort_Vol = smri_vol_scs_crbcortexlh,
FS_L_ThalamusProper_Vol = smri_vol_scs_tplh,
FS_L_Caudate_Vol = smri_vol_scs_caudatelh,
FS_L_Putamen_Vol = smri_vol_scs_putamenlh,
FS_L_Pallidum_Vol = smri_vol_scs_pallidumlh,
FS_3rdVent_Vol = smri_vol_scs_3rdventricle,
FS_4thVent_Vol = smri_vol_scs_4thventricle,
FS_BrainStem_Vol = smri_vol_scs_bstem,
FS_L_Hippo_Vol = smri_vol_scs_hpuslh,
FS_L_Amygdala_Vol =	smri_vol_scs_amygdalalh,
FS_CSF_Vol = smri_vol_scs_csf,
FS_L_AccumbensArea_Vol = smri_vol_scs_aal,
FS_L_VentDC_Vol = smri_vol_scs_vedclh,
#FS_L_Vessel_Vol
#FS_L_ChoroidPlexus_Vol
FS_R_LatVent_Vol = 	smri_vol_scs_ltventriclerh,
FS_R_InfLatVent_Vol = smri_vol_scs_inflatventrh,
FS_R_Cerebellum_WM_Vol = smri_vol_scs_crbwmatterrh,
FS_R_Cerebellum_Cort_Vol = smri_vol_scs_crbcortexrh,
FS_R_ThalamusProper_Vol = smri_vol_scs_tprh,
FS_R_Caudate_Vol = smri_vol_scs_caudaterh,
FS_R_Putamen_Vol = smri_vol_scs_putamenrh,
FS_R_Pallidum_Vol = smri_vol_scs_pallidumrh,
FS_R_Hippo_Vol = smri_vol_scs_hpusrh,
FS_R_Amygdala_Vol = smri_vol_scs_amygdalarh,
FS_R_AccumbensArea_Vol = 	smri_vol_scs_aar,
FS_R_VentDC_Vol = smri_vol_scs_vedcrh,
#FS_R_Vessel_Vol
#FS_R_ChoroidPlexus_Vol
#FS_OpticChiasm_Vol
FS_CC_Posterior_Vol = smri_vol_scs_ccps,
FS_CC_MidPosterior_Vol = smri_vol_scs_ccmidps,
FS_CC_Central_Vol = smri_vol_scs_ccct,
FS_CC_MidAnterior_Vol = smri_vol_scs_ccmidat,
FS_CC_Anterior_Vol = smri_vol_scs_ccat,
FS_L_Bankssts_Area = 	smri_area_cdk_banksstslh,
FS_L_Caudalanteriorcingulate_Area = smri_area_cdk_cdacatelh,
FS_L_Caudalmiddlefrontal_Area = smri_area_cdk_cdmdfrlh,
FS_L_Cuneus_Area = 	smri_area_cdk_cuneuslh,
FS_L_Entorhinal_Area = smri_area_cdk_ehinallh,
FS_L_Fusiform_Area = smri_area_cdk_fusiformlh,
FS_L_Inferiorparietal_Area = smri_area_cdk_ifpllh,
FS_L_Inferiortemporal_Area = smri_area_cdk_iftmlh,
FS_L_Isthmuscingulate_Area = smri_area_cdk_ihcatelh,
FS_L_Lateraloccipital_Area = smri_area_cdk_locclh,
FS_L_Lateralorbitofrontal_Area = smri_area_cdk_lobfrlh,
FS_L_Lingual_Area = smri_area_cdk_linguallh,
FS_L_Medialorbitofrontal_Area = smri_area_cdk_mobfrlh,
FS_L_Middletemporal_Area = smri_area_cdk_mdtmlh,
FS_L_Parahippocampal_Area = smri_area_cdk_parahpallh,
FS_L_Paracentral_Area = smri_area_cdk_paracnlh,
FS_L_Parsopercularis_Area = smri_area_cdk_parsopclh,
FS_L_Parsorbitalis_Area = smri_area_cdk_parsobislh,
FS_L_Parstriangularis_Area = smri_area_cdk_parstgrislh,
FS_L_Pericalcarine_Area = smri_area_cdk_pericclh,
FS_L_Postcentral_Area = smri_area_cdk_postcnlh,
FS_L_Posteriorcingulate_Area = smri_area_cdk_ptcatelh,
FS_L_Precentral_Area = smri_area_cdk_precnlh,
FS_L_Precuneus_Area = smri_area_cdk_pclh,
FS_L_Rostralanteriorcingulate_Area = smri_area_cdk_rracatelh,
FS_L_Rostralmiddlefrontal_Area = smri_area_cdk_rrmdfrlh,
FS_L_Superiorfrontal_Area = smri_area_cdk_sufrlh,
FS_L_Superiorparietal_Area = smri_area_cdk_supllh,
FS_L_Superiortemporal_Area = smri_area_cdk_sutmlh,
FS_L_Supramarginal_Area = smri_area_cdk_smlh,
FS_L_Frontalpole_Area = smri_area_cdk_frpolelh,
FS_L_Temporalpole_Area = smri_area_cdk_tmpolelh,
FS_L_Transversetemporal_Area = smri_area_cdk_trvtmlh,
FS_L_Insula_Area = smri_area_cdk_insulalh,
FS_R_Bankssts_Area = smri_area_cdk_banksstsrh,
FS_R_Caudalanteriorcingulate_Area = smri_area_cdk_cdacaterh,
FS_R_Caudalmiddlefrontal_Area = smri_area_cdk_cdmdfrrh,
FS_R_Cuneus_Area = smri_area_cdk_cuneusrh,
FS_R_Entorhinal_Area = smri_area_cdk_ehinalrh,
FS_R_Fusiform_Area = smri_area_cdk_fusiformrh,
FS_R_Inferiorparietal_Area = smri_area_cdk_ifplrh,
FS_R_Inferiortemporal_Area = 	smri_area_cdk_iftmrh,
FS_R_Isthmuscingulate_Area = smri_area_cdk_ihcaterh,
FS_R_Lateraloccipital_Area = smri_area_cdk_loccrh,
FS_R_Lateralorbitofrontal_Area = smri_area_cdk_lobfrrh,
FS_R_Lingual_Area = smri_area_cdk_lingualrh,
FS_R_Medialorbitofrontal_Area = smri_area_cdk_mobfrrh,
FS_R_Middletemporal_Area = smri_area_cdk_mdtmrh,
FS_R_Parahippocampal_Area = smri_area_cdk_parahpalrh,
FS_R_Paracentral_Area = smri_area_cdk_paracnrh,
FS_R_Parsopercularis_Area = smri_area_cdk_parsopcrh,
FS_R_Parsorbitalis_Area = smri_area_cdk_parsobisrh,
FS_R_Parstriangularis_Area = smri_area_cdk_parstgrisrh,
FS_R_Pericalcarine_Area = smri_area_cdk_periccrh,
FS_R_Postcentral_Area = smri_area_cdk_postcnrh,
FS_R_Posteriorcingulate_Area = smri_area_cdk_ptcaterh,
FS_R_Precentral_Area = smri_area_cdk_precnrh,
FS_R_Precuneus_Area = smri_area_cdk_pcrh,
FS_R_Rostralanteriorcingulate_Area = smri_area_cdk_rracaterh,
FS_R_Rostralmiddlefrontal_Area = smri_area_cdk_rrmdfrrh,
FS_R_Superiorfrontal_Area = smri_area_cdk_sufrrh,
FS_R_Superiorparietal_Area = 	smri_area_cdk_suplrh,
FS_R_Superiortemporal_Area = smri_area_cdk_sutmrh,
FS_R_Supramarginal_Area = smri_area_cdk_smrh,
FS_R_Frontalpole_Area = smri_area_cdk_frpolerh,
FS_R_Temporalpole_Area = smri_area_cdk_tmpolerh,
FS_R_Transversetemporal_Area = smri_area_cdk_trvtmrh,
FS_R_Insula_Area = smri_area_cdk_insularh,
#abcd technically doesn't say gray matter volume for the following varibles
FS_L_Bankssts_GrayVol = smri_vol_cdk_banksstslh,
FS_L_Caudalanteriorcingulate_GrayVol = smri_vol_cdk_cdacatelh,
FS_L_Caudalmiddlefrontal_GrayVol = smri_vol_cdk_cdmdfrlh,
FS_L_Cuneus_GrayVol = smri_vol_cdk_cuneuslh,
FS_L_Entorhinal_GrayVol = smri_vol_cdk_ehinallh,
FS_L_Fusiform_GrayVol = smri_vol_cdk_fusiformlh,
FS_L_Inferiorparietal_GrayVol = smri_vol_cdk_ifpllh,
FS_L_Inferiortemporal_GrayVol = smri_vol_cdk_iftmlh,
FS_L_Isthmuscingulate_GrayVol = smri_vol_cdk_ihcatelh,
FS_L_Lateraloccipital_GrayVol = smri_vol_cdk_locclh,
FS_L_Lateralorbitofrontal_GrayVol = smri_vol_cdk_lobfrlh,
FS_L_Lingual_GrayVol = smri_vol_cdk_linguallh,
FS_L_Medialorbitofrontal_GrayVol = smri_vol_cdk_mobfrlh,
FS_L_Middletemporal_GrayVol = smri_vol_cdk_mdtmlh,
FS_L_Parahippocampal_GrayVol = smri_vol_cdk_parahpallh,
FS_L_Paracentral_GrayVol = smri_vol_cdk_paracnlh,
FS_L_Parsopercularis_GrayVol = smri_vol_cdk_parsopclh,
FS_L_Parsorbitalis_GrayVol = smri_vol_cdk_parsobislh,
FS_L_Parstriangularis_GrayVol = smri_vol_cdk_parstgrislh,
FS_L_Pericalcarine_GrayVol = smri_vol_cdk_pericclh,
FS_L_Postcentral_GrayVol = smri_vol_cdk_postcnlh,
FS_L_Posteriorcingulate_GrayVol = smri_vol_cdk_ptcatelh,
FS_L_Precentral_GrayVol = smri_vol_cdk_precnlh,
FS_L_Precuneus_GrayVol = smri_vol_cdk_pclh,
FS_L_Rostralanteriorcingulate_GrayVol = smri_vol_cdk_rracatelh,
FS_L_Rostralmiddlefrontal_GrayVol = smri_vol_cdk_rrmdfrlh,
FS_L_Superiorfrontal_GrayVol = smri_vol_cdk_sufrlh,
FS_L_Superiorparietal_GrayVol = smri_vol_cdk_supllh,
FS_L_Superiortemporal_GrayVol = smri_vol_cdk_sutmlh,
FS_L_Supramarginal_GrayVol = smri_vol_cdk_smlh,
FS_L_Frontalpole_GrayVol = smri_vol_cdk_frpolelh,
FS_L_Temporalpole_GrayVol = smri_vol_cdk_tmpolelh,
FS_L_Transversetemporal_GrayVol = smri_vol_cdk_trvtmlh,
FS_L_Insula_GrayVol = smri_vol_cdk_insulalh,
FS_R_Bankssts_GrayVol = smri_vol_cdk_banksstsrh,
FS_R_Caudalanteriorcingulate_GrayVol = smri_vol_cdk_cdacaterh,
FS_R_Caudalmiddlefrontal_GrayVol = 	smri_vol_cdk_cdmdfrrh,
FS_R_Cuneus_GrayVol = smri_vol_cdk_cuneusrh,
FS_R_Entorhinal_GrayVol = smri_vol_cdk_ehinalrh,
FS_R_Fusiform_GrayVol = smri_vol_cdk_fusiformrh,
FS_R_Inferiorparietal_GrayVol = smri_vol_cdk_ifplrh,
FS_R_Inferiortemporal_GrayVol = smri_vol_cdk_iftmrh,
FS_R_Isthmuscingulate_GrayVol = smri_vol_cdk_ihcaterh,
FS_R_Lateraloccipital_GrayVol = smri_vol_cdk_loccrh,
FS_R_Lateralorbitofrontal_GrayVol = smri_vol_cdk_lobfrrh,
FS_R_Lingual_GrayVol = smri_vol_cdk_lingualrh,
FS_R_Medialorbitofrontal_GrayVol = smri_vol_cdk_mobfrrh,
FS_R_Middletemporal_GrayVol = smri_vol_cdk_mdtmrh,
FS_R_Parahippocampal_GrayVol = smri_vol_cdk_parahpalrh,
FS_R_Paracentral_GrayVol = smri_vol_cdk_paracnrh,
FS_R_Parsopercularis_GrayVol = smri_vol_cdk_parsopcrh,
FS_R_Parsorbitalis_GrayVol = smri_vol_cdk_parsobisrh,
FS_R_Parstriangularis_GrayVol = smri_vol_cdk_parstgrisrh,
FS_R_Pericalcarine_GrayVol = smri_vol_cdk_periccrh,
FS_R_Postcentral_GrayVol = smri_vol_cdk_postcnrh,
FS_R_Posteriorcingulate_GrayVol = 	smri_vol_cdk_ptcaterh,
FS_R_Precentral_GrayVol = smri_vol_cdk_precnrh,
FS_R_Precuneus_GrayVol = smri_vol_cdk_pcrh,
FS_R_Rostralanteriorcingulate_GrayVol = smri_vol_cdk_rracaterh,
FS_R_Rostralmiddlefrontal_GrayVol = smri_vol_cdk_rrmdfrrh,
FS_R_Superiorfrontal_GrayVol = smri_vol_cdk_sufrrh,
FS_R_Superiorparietal_GrayVol = smri_vol_cdk_suplrh,
FS_R_Superiortemporal_GrayVol = smri_vol_cdk_sutmrh,
FS_R_Supramarginal_GrayVol = smri_vol_cdk_smrh,
FS_R_Frontalpole_GrayVol = smri_vol_cdk_frpolerh,
FS_R_Temporalpole_GrayVol = smri_vol_cdk_tmpolerh,
FS_R_Transversetemporal_GrayVol = smri_vol_cdk_trvtmrh,
FS_R_Insula_GrayVol = smri_vol_cdk_insularh
)


#Create empty columns to match feature list
renamed_smri_baseline[,"FS_BrainSeg_Vol"] <- NA
renamed_smri_baseline[,"FS_BrainSeg_Vol_No_Vent"] <- NA
renamed_smri_baseline[,"FS_BrainSeg_Vol_No_Vent_Surf"] <- NA
renamed_smri_baseline[,"FS_SupraTentorial_Vol_No_Vent"] <- NA
renamed_smri_baseline[,"FS_SupraTentorial_No_Vent_Voxel_Count"] <- NA
renamed_smri_baseline[,"FS_Mask_Vol"] <- NA
renamed_smri_baseline[,"FS_BrainSegVol_eTIV_Ratio"] <- NA
renamed_smri_baseline[,"FS_MaskVol_eTIV_Ratio"] <- NA
renamed_smri_baseline[,"FS_L_Vessel_Vol"] <- NA
renamed_smri_baseline[,"FS_L_ChoroidPlexus_Vol"] <- NA
renamed_smri_baseline[,"FS_R_Vessel_Vol"] <- NA
renamed_smri_baseline[,"FS_R_ChoroidPlexus_Vol"] <- NA
renamed_smri_baseline[,"FS_OpticChiasm_Vol"] <- NA
renamed_smri_baseline[,"FS_Total_GM_Vol"] <- NA

#renamed_smri <- subset(renamed_smri, select = -c(269,279))


#Convert to numeric
renamed_smri_baseline[,6:ncol(renamed_smri_baseline)] <- sapply(renamed_smri_baseline[,6:ncol(renamed_smri_baseline)],as.numeric)
renamed_smri_baseline <- renamed_smri_baseline %>% 
  mutate(interview_age = as.numeric(interview_age)/12)

save(renamed_smri_baseline, file="renamed_smri_baseline.Rda")


smri_abcd_model <- renamed_smri_baseline[, 1:180] 
```

Rename sMRI for follow-up
```{r}

renamed_smri_followup <- smri_followup %>% 
  rename(FS_InterCranial_Vol = smri_vol_scs_intracranialv, #technically inter vs intra
#FS_BrainSeg_Vol
#FS_BrainSeg_Vol_No_Vent
#FS_BrainSeg_Vol_No_Vent_Surf
FS_LCort_GM_Vol = smri_vol_cdk_totallh,
FS_RCort_GM_Vol = smri_vol_cdk_totalrh,
FS_TotCort_GM_Vol = smri_vol_cdk_total, #total whole brain cortical volume
FS_SubCort_GM_Vol = smri_vol_scs_subcorticalgv,
#FS_Total_GM_Vol #maybe just calculate?
FS_SupraTentorial_Vol = smri_vol_scs_suprateialv, #assuming this includes all ventricles
#FS_SupraTentorial_Vol_No_Vent  #smri_vol_scs_allventricles is all ventricles, subtract?
#FS_SupraTentorial_No_Vent_Voxel_Count
#FS_Mask_Vol
#FS_BrainSegVol_eTIV_Ratio
#FS_MaskVol_eTIV_Ratio
FS_L_LatVent_Vol = smri_vol_scs_ltventriclelh,
FS_L_InfLatVent_Vol = smri_vol_scs_inflatventlh,
FS_L_Cerebellum_WM_Vol = smri_vol_scs_crbwmatterlh,
FS_L_Cerebellum_Cort_Vol = smri_vol_scs_crbcortexlh,
FS_L_ThalamusProper_Vol = smri_vol_scs_tplh,
FS_L_Caudate_Vol = smri_vol_scs_caudatelh,
FS_L_Putamen_Vol = smri_vol_scs_putamenlh,
FS_L_Pallidum_Vol = smri_vol_scs_pallidumlh,
FS_3rdVent_Vol = smri_vol_scs_3rdventricle,
FS_4thVent_Vol = smri_vol_scs_4thventricle,
FS_BrainStem_Vol = smri_vol_scs_bstem,
FS_L_Hippo_Vol = smri_vol_scs_hpuslh,
FS_L_Amygdala_Vol =	smri_vol_scs_amygdalalh,
FS_CSF_Vol = smri_vol_scs_csf,
FS_L_AccumbensArea_Vol = smri_vol_scs_aal,
FS_L_VentDC_Vol = smri_vol_scs_vedclh,
#FS_L_Vessel_Vol
#FS_L_ChoroidPlexus_Vol
FS_R_LatVent_Vol = 	smri_vol_scs_ltventriclerh,
FS_R_InfLatVent_Vol = smri_vol_scs_inflatventrh,
FS_R_Cerebellum_WM_Vol = smri_vol_scs_crbwmatterrh,
FS_R_Cerebellum_Cort_Vol = smri_vol_scs_crbcortexrh,
FS_R_ThalamusProper_Vol = smri_vol_scs_tprh,
FS_R_Caudate_Vol = smri_vol_scs_caudaterh,
FS_R_Putamen_Vol = smri_vol_scs_putamenrh,
FS_R_Pallidum_Vol = smri_vol_scs_pallidumrh,
FS_R_Hippo_Vol = smri_vol_scs_hpusrh,
FS_R_Amygdala_Vol = smri_vol_scs_amygdalarh,
FS_R_AccumbensArea_Vol = 	smri_vol_scs_aar,
FS_R_VentDC_Vol = smri_vol_scs_vedcrh,
#FS_R_Vessel_Vol
#FS_R_ChoroidPlexus_Vol
#FS_OpticChiasm_Vol
FS_CC_Posterior_Vol = smri_vol_scs_ccps,
FS_CC_MidPosterior_Vol = smri_vol_scs_ccmidps,
FS_CC_Central_Vol = smri_vol_scs_ccct,
FS_CC_MidAnterior_Vol = smri_vol_scs_ccmidat,
FS_CC_Anterior_Vol = smri_vol_scs_ccat,
FS_L_Bankssts_Area = 	smri_area_cdk_banksstslh,
FS_L_Caudalanteriorcingulate_Area = smri_area_cdk_cdacatelh,
FS_L_Caudalmiddlefrontal_Area = smri_area_cdk_cdmdfrlh,
FS_L_Cuneus_Area = 	smri_area_cdk_cuneuslh,
FS_L_Entorhinal_Area = smri_area_cdk_ehinallh,
FS_L_Fusiform_Area = smri_area_cdk_fusiformlh,
FS_L_Inferiorparietal_Area = smri_area_cdk_ifpllh,
FS_L_Inferiortemporal_Area = smri_area_cdk_iftmlh,
FS_L_Isthmuscingulate_Area = smri_area_cdk_ihcatelh,
FS_L_Lateraloccipital_Area = smri_area_cdk_locclh,
FS_L_Lateralorbitofrontal_Area = smri_area_cdk_lobfrlh,
FS_L_Lingual_Area = smri_area_cdk_linguallh,
FS_L_Medialorbitofrontal_Area = smri_area_cdk_mobfrlh,
FS_L_Middletemporal_Area = smri_area_cdk_mdtmlh,
FS_L_Parahippocampal_Area = smri_area_cdk_parahpallh,
FS_L_Paracentral_Area = smri_area_cdk_paracnlh,
FS_L_Parsopercularis_Area = smri_area_cdk_parsopclh,
FS_L_Parsorbitalis_Area = smri_area_cdk_parsobislh,
FS_L_Parstriangularis_Area = smri_area_cdk_parstgrislh,
FS_L_Pericalcarine_Area = smri_area_cdk_pericclh,
FS_L_Postcentral_Area = smri_area_cdk_postcnlh,
FS_L_Posteriorcingulate_Area = smri_area_cdk_ptcatelh,
FS_L_Precentral_Area = smri_area_cdk_precnlh,
FS_L_Precuneus_Area = smri_area_cdk_pclh,
FS_L_Rostralanteriorcingulate_Area = smri_area_cdk_rracatelh,
FS_L_Rostralmiddlefrontal_Area = smri_area_cdk_rrmdfrlh,
FS_L_Superiorfrontal_Area = smri_area_cdk_sufrlh,
FS_L_Superiorparietal_Area = smri_area_cdk_supllh,
FS_L_Superiortemporal_Area = smri_area_cdk_sutmlh,
FS_L_Supramarginal_Area = smri_area_cdk_smlh,
FS_L_Frontalpole_Area = smri_area_cdk_frpolelh,
FS_L_Temporalpole_Area = smri_area_cdk_tmpolelh,
FS_L_Transversetemporal_Area = smri_area_cdk_trvtmlh,
FS_L_Insula_Area = smri_area_cdk_insulalh,
FS_R_Bankssts_Area = smri_area_cdk_banksstsrh,
FS_R_Caudalanteriorcingulate_Area = smri_area_cdk_cdacaterh,
FS_R_Caudalmiddlefrontal_Area = smri_area_cdk_cdmdfrrh,
FS_R_Cuneus_Area = smri_area_cdk_cuneusrh,
FS_R_Entorhinal_Area = smri_area_cdk_ehinalrh,
FS_R_Fusiform_Area = smri_area_cdk_fusiformrh,
FS_R_Inferiorparietal_Area = smri_area_cdk_ifplrh,
FS_R_Inferiortemporal_Area = 	smri_area_cdk_iftmrh,
FS_R_Isthmuscingulate_Area = smri_area_cdk_ihcaterh,
FS_R_Lateraloccipital_Area = smri_area_cdk_loccrh,
FS_R_Lateralorbitofrontal_Area = smri_area_cdk_lobfrrh,
FS_R_Lingual_Area = smri_area_cdk_lingualrh,
FS_R_Medialorbitofrontal_Area = smri_area_cdk_mobfrrh,
FS_R_Middletemporal_Area = smri_area_cdk_mdtmrh,
FS_R_Parahippocampal_Area = smri_area_cdk_parahpalrh,
FS_R_Paracentral_Area = smri_area_cdk_paracnrh,
FS_R_Parsopercularis_Area = smri_area_cdk_parsopcrh,
FS_R_Parsorbitalis_Area = smri_area_cdk_parsobisrh,
FS_R_Parstriangularis_Area = smri_area_cdk_parstgrisrh,
FS_R_Pericalcarine_Area = smri_area_cdk_periccrh,
FS_R_Postcentral_Area = smri_area_cdk_postcnrh,
FS_R_Posteriorcingulate_Area = smri_area_cdk_ptcaterh,
FS_R_Precentral_Area = smri_area_cdk_precnrh,
FS_R_Precuneus_Area = smri_area_cdk_pcrh,
FS_R_Rostralanteriorcingulate_Area = smri_area_cdk_rracaterh,
FS_R_Rostralmiddlefrontal_Area = smri_area_cdk_rrmdfrrh,
FS_R_Superiorfrontal_Area = smri_area_cdk_sufrrh,
FS_R_Superiorparietal_Area = 	smri_area_cdk_suplrh,
FS_R_Superiortemporal_Area = smri_area_cdk_sutmrh,
FS_R_Supramarginal_Area = smri_area_cdk_smrh,
FS_R_Frontalpole_Area = smri_area_cdk_frpolerh,
FS_R_Temporalpole_Area = smri_area_cdk_tmpolerh,
FS_R_Transversetemporal_Area = smri_area_cdk_trvtmrh,
FS_R_Insula_Area = smri_area_cdk_insularh,
#abcd technically doesn't say gray matter volume for the following varibles
FS_L_Bankssts_GrayVol = smri_vol_cdk_banksstslh,
FS_L_Caudalanteriorcingulate_GrayVol = smri_vol_cdk_cdacatelh,
FS_L_Caudalmiddlefrontal_GrayVol = smri_vol_cdk_cdmdfrlh,
FS_L_Cuneus_GrayVol = smri_vol_cdk_cuneuslh,
FS_L_Entorhinal_GrayVol = smri_vol_cdk_ehinallh,
FS_L_Fusiform_GrayVol = smri_vol_cdk_fusiformlh,
FS_L_Inferiorparietal_GrayVol = smri_vol_cdk_ifpllh,
FS_L_Inferiortemporal_GrayVol = smri_vol_cdk_iftmlh,
FS_L_Isthmuscingulate_GrayVol = smri_vol_cdk_ihcatelh,
FS_L_Lateraloccipital_GrayVol = smri_vol_cdk_locclh,
FS_L_Lateralorbitofrontal_GrayVol = smri_vol_cdk_lobfrlh,
FS_L_Lingual_GrayVol = smri_vol_cdk_linguallh,
FS_L_Medialorbitofrontal_GrayVol = smri_vol_cdk_mobfrlh,
FS_L_Middletemporal_GrayVol = smri_vol_cdk_mdtmlh,
FS_L_Parahippocampal_GrayVol = smri_vol_cdk_parahpallh,
FS_L_Paracentral_GrayVol = smri_vol_cdk_paracnlh,
FS_L_Parsopercularis_GrayVol = smri_vol_cdk_parsopclh,
FS_L_Parsorbitalis_GrayVol = smri_vol_cdk_parsobislh,
FS_L_Parstriangularis_GrayVol = smri_vol_cdk_parstgrislh,
FS_L_Pericalcarine_GrayVol = smri_vol_cdk_pericclh,
FS_L_Postcentral_GrayVol = smri_vol_cdk_postcnlh,
FS_L_Posteriorcingulate_GrayVol = smri_vol_cdk_ptcatelh,
FS_L_Precentral_GrayVol = smri_vol_cdk_precnlh,
FS_L_Precuneus_GrayVol = smri_vol_cdk_pclh,
FS_L_Rostralanteriorcingulate_GrayVol = smri_vol_cdk_rracatelh,
FS_L_Rostralmiddlefrontal_GrayVol = smri_vol_cdk_rrmdfrlh,
FS_L_Superiorfrontal_GrayVol = smri_vol_cdk_sufrlh,
FS_L_Superiorparietal_GrayVol = smri_vol_cdk_supllh,
FS_L_Superiortemporal_GrayVol = smri_vol_cdk_sutmlh,
FS_L_Supramarginal_GrayVol = smri_vol_cdk_smlh,
FS_L_Frontalpole_GrayVol = smri_vol_cdk_frpolelh,
FS_L_Temporalpole_GrayVol = smri_vol_cdk_tmpolelh,
FS_L_Transversetemporal_GrayVol = smri_vol_cdk_trvtmlh,
FS_L_Insula_GrayVol = smri_vol_cdk_insulalh,
FS_R_Bankssts_GrayVol = smri_vol_cdk_banksstsrh,
FS_R_Caudalanteriorcingulate_GrayVol = smri_vol_cdk_cdacaterh,
FS_R_Caudalmiddlefrontal_GrayVol = 	smri_vol_cdk_cdmdfrrh,
FS_R_Cuneus_GrayVol = smri_vol_cdk_cuneusrh,
FS_R_Entorhinal_GrayVol = smri_vol_cdk_ehinalrh,
FS_R_Fusiform_GrayVol = smri_vol_cdk_fusiformrh,
FS_R_Inferiorparietal_GrayVol = smri_vol_cdk_ifplrh,
FS_R_Inferiortemporal_GrayVol = smri_vol_cdk_iftmrh,
FS_R_Isthmuscingulate_GrayVol = smri_vol_cdk_ihcaterh,
FS_R_Lateraloccipital_GrayVol = smri_vol_cdk_loccrh,
FS_R_Lateralorbitofrontal_GrayVol = smri_vol_cdk_lobfrrh,
FS_R_Lingual_GrayVol = smri_vol_cdk_lingualrh,
FS_R_Medialorbitofrontal_GrayVol = smri_vol_cdk_mobfrrh,
FS_R_Middletemporal_GrayVol = smri_vol_cdk_mdtmrh,
FS_R_Parahippocampal_GrayVol = smri_vol_cdk_parahpalrh,
FS_R_Paracentral_GrayVol = smri_vol_cdk_paracnrh,
FS_R_Parsopercularis_GrayVol = smri_vol_cdk_parsopcrh,
FS_R_Parsorbitalis_GrayVol = smri_vol_cdk_parsobisrh,
FS_R_Parstriangularis_GrayVol = smri_vol_cdk_parstgrisrh,
FS_R_Pericalcarine_GrayVol = smri_vol_cdk_periccrh,
FS_R_Postcentral_GrayVol = smri_vol_cdk_postcnrh,
FS_R_Posteriorcingulate_GrayVol = 	smri_vol_cdk_ptcaterh,
FS_R_Precentral_GrayVol = smri_vol_cdk_precnrh,
FS_R_Precuneus_GrayVol = smri_vol_cdk_pcrh,
FS_R_Rostralanteriorcingulate_GrayVol = smri_vol_cdk_rracaterh,
FS_R_Rostralmiddlefrontal_GrayVol = smri_vol_cdk_rrmdfrrh,
FS_R_Superiorfrontal_GrayVol = smri_vol_cdk_sufrrh,
FS_R_Superiorparietal_GrayVol = smri_vol_cdk_suplrh,
FS_R_Superiortemporal_GrayVol = smri_vol_cdk_sutmrh,
FS_R_Supramarginal_GrayVol = smri_vol_cdk_smrh,
FS_R_Frontalpole_GrayVol = smri_vol_cdk_frpolerh,
FS_R_Temporalpole_GrayVol = smri_vol_cdk_tmpolerh,
FS_R_Transversetemporal_GrayVol = smri_vol_cdk_trvtmrh,
FS_R_Insula_GrayVol = smri_vol_cdk_insularh
)


#Create empty columns to match feature list
renamed_smri_baseline[,"FS_BrainSeg_Vol"] <- NA
renamed_smri_baseline[,"FS_BrainSeg_Vol_No_Vent"] <- NA
renamed_smri_baseline[,"FS_BrainSeg_Vol_No_Vent_Surf"] <- NA
renamed_smri_baseline[,"FS_SupraTentorial_Vol_No_Vent"] <- NA
renamed_smri_baseline[,"FS_SupraTentorial_No_Vent_Voxel_Count"] <- NA
renamed_smri_baseline[,"FS_Mask_Vol"] <- NA
renamed_smri_baseline[,"FS_BrainSegVol_eTIV_Ratio"] <- NA
renamed_smri_baseline[,"FS_MaskVol_eTIV_Ratio"] <- NA
renamed_smri_baseline[,"FS_L_Vessel_Vol"] <- NA
renamed_smri_baseline[,"FS_L_ChoroidPlexus_Vol"] <- NA
renamed_smri_baseline[,"FS_R_Vessel_Vol"] <- NA
renamed_smri_baseline[,"FS_R_ChoroidPlexus_Vol"] <- NA
renamed_smri_baseline[,"FS_OpticChiasm_Vol"] <- NA
renamed_smri_baseline[,"FS_Total_GM_Vol"] <- NA

#renamed_smri <- subset(renamed_smri, select = -c(269,279))


#Convert to numeric
renamed_smri_baseline[,6:ncol(renamed_smri_baseline)] <- sapply(renamed_smri_baseline[,6:ncol(renamed_smri_baseline)],as.numeric)
renamed_smri_baseline <- renamed_smri_baseline %>% 
  mutate(interview_age = as.numeric(interview_age)/12)

save(renamed_smri_baseline, file="renamed_smri_baseline.Rda")


smri_abcd_model <- renamed_smri_baseline[, 1:180] 

```





Split Samples
```{r}
load("/Volumes/devbrainlab/Lucy/BrainAGE/fyp/Sample1.Rda")
load("/Volumes/devbrainlab/Lucy/BrainAGE/fyp/Sample2.Rda")
load("renamed_smri_baseline.Rda")


training_sample_baseline <- filter(smri_abcd_model , src_subject_id %in% sample_1$src_subject_id) %>% 
  select(-c(subjectkey, src_subject_id, sex, eventname))

analysis_sample_baseline <- filter(smri_abcd_model , src_subject_id %in% sample_2$src_subject_id)

save(training_sample_baseline, file="training_sample_baseline.Rds")
save(analysis_sample_baseline, file="analysis_sample_baseline.Rds")

```

Make dataframe for ML testing
```{r, eval = F}
train_test <- training_sample_baseline %>% 
  #select(1:15) %>% 
  slice_head(n=20)

#validation_test <- df_validation_baseline %>% 
  #select(1:15) %>% 
#  slice_head(n=20)

save(train_test, file="train_test.Rds")
#save(validation_test, file="validation_test.Rds")

```

Feature list template
```{r, eval=F}
#Template
FS_InterCranial_Vol = smri_vol_scs_intracranialv, #technically inter vs intra
FS_BrainSeg_Vol
FS_BrainSeg_Vol_No_Vent
FS_BrainSeg_Vol_No_Vent_Surf
FS_LCort_GM_Vol = smri_vol_cdk_totallh,
FS_RCort_GM_Vol = smri_vol_cdk_totalrh,
FS_TotCort_GM_Vol = smri_vol_cdk_total, #total whole brain cortical volume
FS_SubCort_GM_Vol = smri_vol_scs_subcorticalgv,
FS_Total_GM_Vol #maybe just calculate?
FS_SupraTentorial_Vol = smri_vol_scs_suprateialv, #assuming this includes all ventricles
FS_SupraTentorial_Vol_No_Vent  #smri_vol_scs_allventricles is all ventricles, subtract?
FS_SupraTentorial_No_Vent_Voxel_Count
FS_Mask_Vol
FS_BrainSegVol_eTIV_Ratio
FS_MaskVol_eTIV_Ratio
FS_L_LatVent_Vol = smri_vol_scs_ltventriclelh,
FS_L_InfLatVent_Vol = smri_vol_scs_inflatventlh,
FS_L_Cerebellum_WM_Vol = smri_vol_scs_crbwmatterlh,
FS_L_Cerebellum_Cort_Vol = smri_vol_scs_crbcortexlh,
FS_L_ThalamusProper_Vol = smri_vol_scs_tplh,
FS_L_Caudate_Vol = smri_vol_scs_caudatelh,
FS_L_Putamen_Vol = smri_vol_scs_putamenlh,
FS_L_Pallidum_Vol = smri_vol_scs_pallidumlh,
FS_3rdVent_Vol = 	smri_vol_scs_3rdventricle,
FS_4thVent_Vol = smri_vol_scs_4thventricle,
FS_BrainStem_Vol = smri_vol_scs_bstem,
FS_L_Hippo_Vol = smri_vol_scs_hpuslh,
FS_L_Amygdala_Vol =	smri_vol_scs_amygdalalh,
FS_CSF_Vol = 	smri_vol_scs_csf,
FS_L_AccumbensArea_Vol = 	smri_vol_scs_aal,
FS_L_VentDC_Vol = smri_vol_scs_vedclh,
FS_L_Vessel_Vol
FS_L_ChoroidPlexus_Vol
FS_R_LatVent_Vol = smri_vol_scs_ltventriclerh,
FS_R_InfLatVent_Vol = smri_vol_scs_inflatventrh,
FS_R_Cerebellum_WM_Vol = smri_vol_scs_crbwmatterrh,

# no cerebellum cort vol?
FS_R_ThalamusProper_Vol = smri_vol_scs_tprh,
FS_R_Caudate_Vol = smri_vol_scs_caudaterh,
FS_R_Putamen_Vol = smri_vol_scs_putamenrh,
FS_R_Pallidum_Vol = smri_vol_scs_pallidumrh,
FS_R_Hippo_Vol = 	smri_vol_scs_hpusrh,
FS_R_Amygdala_Vol = smri_vol_scs_amygdalarh,
FS_R_AccumbensArea_Vol = smri_vol_scs_aar,
FS_R_VentDC_Vol = smri_vol_scs_vedcrh,
FS_R_Vessel_Vol
FS_R_ChoroidPlexus_Vol
FS_OpticChiasm_Vol
FS_CC_Posterior_Vol = smri_vol_scs_ccps,
FS_CC_MidPosterior_Vol = smri_vol_scs_ccmidps,
FS_CC_Central_Vol = smri_vol_scs_ccct,
FS_CC_MidAnterior_Vol = smri_vol_scs_ccmidat,
FS_CC_Anterior_Vol = smri_vol_scs_ccat,
FS_L_Bankssts_Area = 	smri_area_cdk_banksstslh,
FS_L_Caudalanteriorcingulate_Area = smri_area_cdk_cdacatelh,
FS_L_Caudalmiddlefrontal_Area = smri_area_cdk_cdmdfrlh,
FS_L_Cuneus_Area = 	smri_area_cdk_cuneuslh,
FS_L_Entorhinal_Area = smri_area_cdk_ehinallh,
FS_L_Fusiform_Area = smri_area_cdk_fusiformlh,
FS_L_Inferiorparietal_Area = smri_area_cdk_ifpllh,
FS_L_Inferiortemporal_Area = smri_area_cdk_iftmlh,
FS_L_Isthmuscingulate_Area = smri_area_cdk_ihcatelh,
FS_L_Lateraloccipital_Area = smri_area_cdk_locclh,
FS_L_Lateralorbitofrontal_Area = smri_area_cdk_lobfrlh,
FS_L_Lingual_Area = smri_area_cdk_linguallh,
FS_L_Medialorbitofrontal_Area = smri_area_cdk_mobfrlh,
FS_L_Middletemporal_Area = smri_area_cdk_mdtmlh,
FS_L_Parahippocampal_Area = smri_area_cdk_parahpallh,
FS_L_Paracentral_Area = smri_area_cdk_paracnlh,
FS_L_Parsopercularis_Area = smri_area_cdk_parsopclh,
FS_L_Parsorbitalis_Area = smri_area_cdk_parsobislh,
FS_L_Parstriangularis_Area = smri_area_cdk_parstgrislh,
FS_L_Pericalcarine_Area = smri_area_cdk_pericclh,
FS_L_Postcentral_Area = smri_area_cdk_postcnlh,
FS_L_Posteriorcingulate_Area = smri_area_cdk_ptcatelh,
FS_L_Precentral_Area = smri_area_cdk_precnlh,
FS_L_Precuneus_Area = smri_area_cdk_pclh,
FS_L_Rostralanteriorcingulate_Area = smri_area_cdk_rracatelh,
FS_L_Rostralmiddlefrontal_Area = smri_area_cdk_rrmdfrlh,
FS_L_Superiorfrontal_Area = smri_area_cdk_sufrlh,
FS_L_Superiorparietal_Area = smri_area_cdk_supllh,
FS_L_Superiortemporal_Area = smri_area_cdk_sutmlh,
FS_L_Supramarginal_Area = smri_area_cdk_smlh,
FS_L_Frontalpole_Area = smri_area_cdk_frpolelh,
FS_L_Temporalpole_Area = smri_area_cdk_tmpolelh,
FS_L_Transversetemporal_Area = smri_area_cdk_trvtmlh,
FS_L_Insula_Area = smri_area_cdk_insulalh,
FS_R_Bankssts_Area = smri_area_cdk_banksstsrh,
FS_R_Caudalanteriorcingulate_Area = smri_area_cdk_cdacaterh,
FS_R_Caudalmiddlefrontal_Area = smri_area_cdk_cdmdfrrh,
FS_R_Cuneus_Area = smri_area_cdk_cuneusrh,
FS_R_Entorhinal_Area = smri_area_cdk_ehinalrh,
FS_R_Fusiform_Area = smri_area_cdk_fusiformrh,
FS_R_Inferiorparietal_Area = smri_area_cdk_ifplrh,
FS_R_Inferiortemporal_Area = 	smri_area_cdk_iftmrh,
FS_R_Isthmuscingulate_Area = smri_area_cdk_ihcaterh,
FS_R_Lateraloccipital_Area = smri_area_cdk_loccrh,
FS_R_Lateralorbitofrontal_Area = smri_area_cdk_lobfrrh,
FS_R_Lingual_Area = smri_area_cdk_lingualrh,
FS_R_Medialorbitofrontal_Area = smri_area_cdk_mobfrrh,
FS_R_Middletemporal_Area = smri_area_cdk_mdtmrh,
FS_R_Parahippocampal_Area = smri_area_cdk_parahpalrh,
FS_R_Paracentral_Area = smri_area_cdk_paracnrh,
FS_R_Parsopercularis_Area = smri_area_cdk_parsopcrh,
FS_R_Parsorbitalis_Area = smri_area_cdk_parsobisrh,
FS_R_Parstriangularis_Area = smri_area_cdk_parstgrisrh,
FS_R_Pericalcarine_Area = smri_area_cdk_periccrh,
FS_R_Postcentral_Area = smri_area_cdk_postcnrh,
FS_R_Posteriorcingulate_Area = smri_area_cdk_ptcaterh,
FS_R_Precentral_Area = smri_area_cdk_precnrh,
FS_R_Precuneus_Area = smri_area_cdk_pcrh,
FS_R_Rostralanteriorcingulate_Area = smri_area_cdk_rracaterh,
FS_R_Rostralmiddlefrontal_Area = smri_area_cdk_rrmdfrrh,
FS_R_Superiorfrontal_Area = smri_area_cdk_sufrrh,
FS_R_Superiorparietal_Area = 	smri_area_cdk_suplrh,
FS_R_Superiortemporal_Area = smri_area_cdk_sutmrh,
FS_R_Supramarginal_Area = smri_area_cdk_smrh,
FS_R_Frontalpole_Area = smri_area_cdk_frpolerh,
FS_R_Temporalpole_Area = smri_area_cdk_tmpolerh,
FS_R_Transversetemporal_Area = smri_area_cdk_trvtmrh,
FS_R_Insula_Area = 	smri_area_cdk_insularh,
#abcd technically doesn't say gray matter volume for the following varibles
FS_L_Bankssts_GrayVol = smri_vol_cdk_banksstslh,
FS_L_Caudalanteriorcingulate_GrayVol = smri_vol_cdk_cdacatelh,
FS_L_Caudalmiddlefrontal_GrayVol = smri_vol_cdk_cdmdfrlh,
FS_L_Cuneus_GrayVol = smri_vol_cdk_cuneuslh,
FS_L_Entorhinal_GrayVol = smri_vol_cdk_ehinallh,
FS_L_Fusiform_GrayVol = smri_vol_cdk_fusiformlh,
FS_L_Inferiorparietal_GrayVol = smri_vol_cdk_ifpllh,
FS_L_Inferiortemporal_GrayVol = smri_vol_cdk_iftmlh,
FS_L_Isthmuscingulate_GrayVol = smri_vol_cdk_ihcatelh,
FS_L_Lateraloccipital_GrayVol = smri_vol_cdk_locclh,
FS_L_Lateralorbitofrontal_GrayVol = smri_vol_cdk_lobfrlh,
FS_L_Lingual_GrayVol = smri_vol_cdk_linguallh,
FS_L_Medialorbitofrontal_GrayVol = smri_vol_cdk_mobfrlh,
FS_L_Middletemporal_GrayVol = smri_vol_cdk_mdtmlh,
FS_L_Parahippocampal_GrayVol = smri_vol_cdk_parahpallh,
FS_L_Paracentral_GrayVol = smri_vol_cdk_paracnlh,
FS_L_Parsopercularis_GrayVol = smri_vol_cdk_parsopclh,
FS_L_Parsorbitalis_GrayVol = smri_vol_cdk_parsobislh,
FS_L_Parstriangularis_GrayVol = smri_vol_cdk_parstgrislh,
FS_L_Pericalcarine_GrayVol = smri_vol_cdk_pericclh,
FS_L_Postcentral_GrayVol = smri_vol_cdk_postcnlh,
FS_L_Posteriorcingulate_GrayVol = smri_vol_cdk_ptcatelh,
FS_L_Precentral_GrayVol = smri_vol_cdk_precnlh,
FS_L_Precuneus_GrayVol = smri_vol_cdk_pclh,
FS_L_Rostralanteriorcingulate_GrayVol = smri_vol_cdk_rracatelh,
FS_L_Rostralmiddlefrontal_GrayVol = smri_vol_cdk_rrmdfrlh,
FS_L_Superiorfrontal_GrayVol = smri_vol_cdk_sufrlh,
FS_L_Superiorparietal_GrayVol = smri_vol_cdk_supllh,
FS_L_Superiortemporal_GrayVol = smri_vol_cdk_sutmlh,
FS_L_Supramarginal_GrayVol = smri_vol_cdk_smlh,
FS_L_Frontalpole_GrayVol = smri_vol_cdk_frpolelh,
FS_L_Temporalpole_GrayVol = smri_vol_cdk_tmpolelh,
FS_L_Transversetemporal_GrayVol = smri_vol_cdk_trvtmlh,
FS_L_Insula_GrayVol = smri_vol_cdk_insulalh,
FS_R_Bankssts_GrayVol = smri_vol_cdk_banksstsrh,
FS_R_Caudalanteriorcingulate_GrayVol = smri_vol_cdk_cdacaterh,
FS_R_Caudalmiddlefrontal_GrayVol = 	smri_vol_cdk_cdmdfrrh,
FS_R_Cuneus_GrayVol = smri_vol_cdk_cuneusrh,
FS_R_Entorhinal_GrayVol = smri_vol_cdk_ehinalrh,
FS_R_Fusiform_GrayVol = smri_vol_cdk_fusiformrh,
FS_R_Inferiorparietal_GrayVol = smri_vol_cdk_ifplrh,
FS_R_Inferiortemporal_GrayVol = smri_vol_cdk_iftmrh,
FS_R_Isthmuscingulate_GrayVol = smri_vol_cdk_ihcaterh,
FS_R_Lateraloccipital_GrayVol = smri_vol_cdk_loccrh,
FS_R_Lateralorbitofrontal_GrayVol = smri_vol_cdk_lobfrrh,
FS_R_Lingual_GrayVol = smri_vol_cdk_lingualrh,
FS_R_Medialorbitofrontal_GrayVol = smri_vol_cdk_mobfrrh,
FS_R_Middletemporal_GrayVol = smri_vol_cdk_mdtmrh,
FS_R_Parahippocampal_GrayVol = smri_vol_cdk_parahpalrh,
FS_R_Paracentral_GrayVol = smri_vol_cdk_paracnrh,
FS_R_Parsopercularis_GrayVol = smri_vol_cdk_parsopcrh,
FS_R_Parsorbitalis_GrayVol = smri_vol_cdk_parsobisrh,
FS_R_Parstriangularis_GrayVol = smri_vol_cdk_parstgrisrh,
FS_R_Pericalcarine_GrayVol = smri_vol_cdk_periccrh,
FS_R_Postcentral_GrayVol = smri_vol_cdk_postcnrh,
FS_R_Posteriorcingulate_GrayVol = 	smri_vol_cdk_ptcaterh,
FS_R_Precentral_GrayVol = smri_vol_cdk_precnrh,
FS_R_Precuneus_GrayVol = smri_vol_cdk_pcrh,
FS_R_Rostralanteriorcingulate_GrayVol = smri_vol_cdk_rracaterh,
FS_R_Rostralmiddlefrontal_GrayVol = smri_vol_cdk_rrmdfrrh,
FS_R_Superiorfrontal_GrayVol = smri_vol_cdk_sufrrh,
FS_R_Superiorparietal_GrayVol = smri_vol_cdk_suplrh,
FS_R_Superiortemporal_GrayVol = smri_vol_cdk_sutmrh,
FS_R_Supramarginal_GrayVol = smri_vol_cdk_smrh,
FS_R_Frontalpole_GrayVol = smri_vol_cdk_frpolerh,
FS_R_Temporalpole_GrayVol = smri_vol_cdk_tmpolerh,
FS_R_Transversetemporal_GrayVol = smri_vol_cdk_trvtmrh,
FS_R_Insula_GrayVol = smri_vol_cdk_insularh


```


```{r}
#Puberty
#Raw scores, youth
youth_pds_followup <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_ypdms01.txt") %>%
  filter(!collection_title=="collection_title") %>% 
  filter(eventname == "2_year_follow_up_y_arm_1") %>% 
  select(5:38) %>% 
  select(-c(interview_date, pds_remote___1, pds_remote___2, pds_remote___3, pds_remote___4, pds_device)) %>% 
  mutate_at(c(5:28), as.numeric)

#Raw scores, parent
parent_pds_followup <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_ppdms01.txt") %>%
  filter(!collection_title=="collection_title")  %>% 
  filter(eventname== "2_year_follow_up_y_arm_1") %>% 
  select(5:27) %>% 
  select(-c(interview_date, pds_select_language___1)) %>% 
  mutate_at(c(5:21), as.numeric)

#Cognition Scores (Age-Corrected)
cognition_followup <- rio::import("/Volumes/devbrainlab/ABCD_Data/ABCD4pt0/abcd_tbss01.txt") %>%
  filter(!collection_title=="collection_title")  %>% 
  filter(eventname == "2_year_follow_up_y_arm_1") %>% 
  select(src_subject_id,interview_age, nihtbx_fluidcomp_agecorrected, nihtbx_cryst_agecorrected, nihtbx_totalcomp_agecorrected) %>% 
  mutate_at(c(2:5), as.numeric)

	
#Existing Models
corrected_followup_brainage <- rio::import("/Volumes/devbrainlab/Lucy/BrainAGE/FYP/FollowUpBrainAgeCorrected.Rda")
```


## Format BrainAge
```{r}
corrected_followup_brainage$src_subject_id <- smri_followup$src_subject_id
```
## Format Puberty Data 
```{r}
#two or more missing values = exclude
#PDS mean score is a continuous value calculated by averaging across PDS items following Herting et al. (2021). Items on the PDS were considered missing if participants answered, “I don’t know” or “refuse to answer”, if the response was left blank, or if the response value was outside of the expected range (1 to 4). Participants with two or more missing answers were excluded from the PDS score calculation (following recommendations from (Herting et al., 2021)

youth_pds_followup[youth_pds_followup == 777] <- NA
youth_pds_followup[youth_pds_followup == 999] <- NA

#Youth-report, removes everyone w/o complete data
youth_pds_followup <- youth_pds_followup %>% 
  mutate(youth_sum = case_when(sex == "M" ~ #male
                           (pds_ht2_y + pds_bdyhair_y + pds_skin2_y + pds_m4_y + pds_m5_y),  
                         sex == "F" ~ #female
                           (pds_ht2_y + pds_bdyhair_y + pds_skin2_y + pds_f4_2_y + pds_f5_y))) %>% 
  mutate(youth_mean = youth_sum/5) 

youth_pds_use_followup <- youth_pds_followup %>% 
  select(src_subject_id, sex, youth_sum, youth_mean)

#Parent-report, removes everyone w/o complete data
parent_pds_followup[parent_pds_followup == 777] <- NA
parent_pds_followup[parent_pds_followup == 999] <- NA
parent_pds_followup <- parent_pds_followup %>% 
    mutate(parent_sum = case_when(sex == "M" ~ #male
                           (pds_1_p + pds_2_p + pds_3_p + pds_m4_p + pds_m5_p),  
                         sex == "F" ~ #female
                           (pds_1_p + pds_2_p + pds_3_p + pds_f4_p + pds_f5b_p))) %>% 
  mutate(parent_mean = parent_sum/5)

parent_pds_use_followup <- parent_pds_followup %>% 
  select(src_subject_id, sex, parent_sum, parent_mean)
```


## Make big dataframe
```{r}
brainage_pds_followup <- corrected_followup_brainage[, c(6,1:5)] %>% 
  left_join(youth_pds_use_followup) %>% 
  left_join(parent_pds_use_followup) %>% 
  left_join(cognition_followup)


#Split sample
smp_size_followup <- floor(0.5 * nrow(brainage_pds_followup))

## set the seed to make your partition reproducible
set.seed(123)
sample_ind_followup <- sample(seq_len(nrow(brainage_pds_followup)), size = smp_size_followup)

sample_1_followup <- brainage_pds_followup[sample_ind_followup, ]
sample_2_followup <- brainage_pds_followup[-sample_ind_followup, ]

#t test for age differences
t.test(sample_1_followup$interview_age, sample_2_followup$interview_age)

#Save samples
save(brainage_pds_followup, file="BrainagePDSFollowUp.Rda")
save(sample_1_followup, file="Sample1FollowUp.Rda")
save(sample_2_followup, file = "Sample2FollowUp.Rda")

```


Attach baseline pds/cognition data to sample 2 / abcd model brainage

## Format BrainAge
```{r}
abcd_brainage_baseline$src_subject_id <- sample_2$src_subject_id

abcd_brainage_baseline <- abcd_brainage_baseline[, c(6,1:5)]
```

```{r}
abcd_baseline <- sample_2 %>% 
  select(1, 7:16)

abcd_baseline <- left_join(abcd_baseline, abcd_brainage_baseline)
  
str(abcd_baseline)

save(abcd_baseline, file="abcd_baseline.Rda")
```

#################
Make Dataframe of sMRI features for combined wave model
################
```{r}



```
